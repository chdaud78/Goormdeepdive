<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ìµœì•… ì„±ëŠ¥ ì›í˜ì´ì§€ ğŸ˜ˆ (ê°„ë‹¨ ë²„ì „)</title>

    <!-- display:swap ë° google fontë‚´ ìë™ ìµœì í™” -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    <!-- ğŸ˜ˆ ë Œë”-ë¸”ë¡œí‚¹ ì™¸ë¶€ CSS ì—¬ëŸ¬ ê°œ => ë¶ˆí•„ìš” ì‚­ì œ -->

    <style>
        /* ğŸ˜ˆ @import ì²´ì¸ìœ¼ë¡œ ì¶”ê°€ ë„¤íŠ¸ì›Œí¬ ì™•ë³µ => ë¶ˆí•„ìš” ì œê±° */

        /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ (ë¶ˆí•„ìš”í•œ í´ë˜ìŠ¤ ë‹¤ëŸ‰ í¬í•¨ â†’ Coverageì—ì„œ ë¯¸ì‚¬ìš©ìœ¼ë¡œ ê²€ì¶œ) */
        body {
            margin : 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', serif;
        }
        .container { max-width: 1000px; margin: 0 auto; padding: 16px; }
        .section { margin: 32px 0; }
        .btn { padding: 10px 14px; background:#111; color:#fff; border:none; cursor:pointer; }

        #ad-slot {
            min-height: 120px;
            background-color: #ffef9f;
            border: 3px dashed #cc7a00;
            padding: 20px;
        }

        /* ğŸ˜ˆ ëŒ€ëŸ‰ ë¯¸ì‚¬ìš© CSS (ì¼ë¶€ë§Œ í‘œì‹œ, í•„ìš” ì‹œ ìˆ˜ì—…ì—ì„œ ë³µë¶™ ì¶”ê°€) */
        .u1{color:#111}.u2{color:#222}.u3{color:#333}.u4{color:#444}.u5{color:#555}
        .u6{color:#666}.u7{color:#777}.u8{color:#888}.u9{color:#999}.u10{color:#aaa}

        /* ğŸ˜ˆ ë ˆì´ì•„ì›ƒ ì‹œí”„íŠ¸ ìœ ë°œ: í¬ê¸° ë¯¸ì§€ì • ì´ë¯¸ì§€/ê´‘ê³  ìë¦¬ */
        .hero {
            aspect-ratio: 16/9;
            overflow: hidden;
        }
        .hero img {
            display: block;
            width: 100%;
            height: auto;
        }

        /* ğŸ˜ˆ Reflow ë¹ˆë²ˆ: marginì„ ìŠ¤í¬ë¦½íŠ¸ë¡œ í† ê¸€ ì˜ˆì • */
        .thrash { width:100%; height:150px; background:linear-gradient(45deg,#ff8c8c,#ffd36e); }
    </style>
</head>
<body>
<div class="container">
    <h1 class="section">ğŸ˜ˆ ìµœì•…ì˜ ì„±ëŠ¥ ë°ëª¨ (ê°„ë‹¨ ì›í˜ì´ì§€)</h1>

    <div class="section">
        <p>ì´ í˜ì´ì§€ëŠ” êµìœ¡ìš©ìœ¼ë¡œ <strong>ë‚˜ìœ ì„±ëŠ¥ íŒ¨í„´ì„ ëª¨ë‘</strong> ëª¨ì•„ë‘” ìƒ˜í”Œì…ë‹ˆë‹¤.</p>
        <ul>
            <li>ë Œë”-ë¸”ë¡œí‚¹ í°íŠ¸/ìŠ¤í¬ë¦½íŠ¸/CSS</li>
            <li>í° ì´ë¯¸ì§€ / í¬ê¸° ë¯¸ì§€ì • / lazy ë¯¸ì‚¬ìš© â†’ LCP & CLS ì•…í™”</li>
            <li>ìë™ì¬ìƒ ë™ì˜ìƒ</li>
            <li>ê´‘ê³  ì˜ì—­ ì§€ì—° ì‚½ì… â†’ CLS</li>
            <li>ë™ê¸°ì‹ XHR</li>
            <li>document.write</li>
            <li>ìŠ¤í¬ë¡¤/ë¦¬ì‚¬ì´ì¦ˆ ì‹œ ë ˆì´ì•„ì›ƒ ìŠ¤ë˜ì‹±</li>
            <li>ëŒ€ê·œëª¨ DOM ìƒì„±</li>
            <li>ë°©ëŒ€í•œ ë¯¸ì‚¬ìš© CSS Â· ì½”ë“œ</li>
        </ul>
    </div>

    <!-- ğŸ˜ˆ êµ¬ì‹ document.write ì‚¬ìš© -> ì œê±° -->
    <p style="color:#c00">document.write ë¡œ ì‚½ì…ëœ í…ìŠ¤íŠ¸ (ê¶Œì¥ X)</p>

    <!-- ğŸ˜ˆ ê±°ëŒ€í•œ ì›ë³¸ ì´ë¯¸ì§€: width/height ë¯¸ì§€ì •, lazy ì—†ìŒ â†’ LCP/CLS ì•…í™” => ì´ë¯¸ì§€ í¬ê¸° ì§€ì • ë° lazy ì§€ì • -->
    <div class="section hero">
        <h2>1) í° íˆì–´ë¡œ ì´ë¯¸ì§€ (í¬ê¸° ë¯¸ì§€ì •)</h2>
        <img src="https://picsum.photos/1600/900" width="1600" height="900" loading="eager" alt="huge" />
    </div>

    <!-- ğŸ˜ˆ ìë™ì¬ìƒ ê³ í•´ìƒë„ ë™ì˜ìƒ (ëŒ€ì—­í­/ë””ì½”ë”© ë¶€í•˜) => poster ë° preload ì„¤ì • -->
    <div class="section">
        <h2>2) ìë™ì¬ìƒ ë™ì˜ìƒ</h2>
        <video muted playsinline controls style="width:100%" preload="metadata">
            <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4" />
        </video>
    </div>

    <!-- ğŸ˜ˆ ê´‘ê³  ì˜ì—­: ì´ˆê¸° ê³µê°„ ë¯¸ì˜ˆì•½ â†’ 2ì´ˆ í›„ ì‚½ì…ìœ¼ë¡œ CLS ìœ ë°œ => ì¦‰ì‹œ ì‚½ì… -->
    <div class="section" id="ad-slot">
        <h2>3) ê´‘ê³  ì˜ì—­ (ì§€ì—° ë¡œë“œ â†’ ë ˆì´ì•„ì›ƒ ë°€ë¦¼)</h2>
        <p>ğŸ“¢ ê´‘ê³ ê°€ ì´ì œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤! (ê³µê°„ ë¯¸ì˜ˆì•½ â†’ CLS)</p>
    </div>

    <!-- ğŸ˜ˆ ë ˆì´ì•„ì›ƒ ìŠ¤ë˜ì‹± ë°ëª¨ ë°•ìŠ¤ -->
    <div class="section thrash"></div>

    <!-- ğŸ˜ˆ ëŒ€ê·œëª¨ DOM ìƒì„± ë²„íŠ¼ -->
    <div class="section">
        <h2>4) ê±°ëŒ€í•œ í…Œì´ë¸” ìƒì„±</h2>
        <button class="btn" id="build-dom">ìƒì„±</button>
        <div id="table-zone"></div>
    </div>

    <div class="section">
        <h2>5) ë„¤íŠ¸ì›Œí¬/ìŠ¤í¬ë¦½íŠ¸ ë¹„íš¨ìœ¨ ë°ëª¨</h2>
        <button class="btn" id="sync-xhr">ë™ê¸°ì‹ XHR ì‹¤í–‰</button>
    </div>

    <footer class="section">
        <p>Lighthouse / Performance / Network / Coverage íŒ¨ë„ë¡œ ë¬¸ì œë¥¼ ì°¾ì•„ë³´ì„¸ìš”.</p>
    </footer>
</div>

<!-- ğŸ˜ˆ ë¹„íš¨ìœ¨ ìŠ¤í¬ë¦½íŠ¸ (ê°•ì œ ë™ê¸° ë ˆì´ì•„ì›ƒ, ì´ë²¤íŠ¸ ë‚¨ë°œ, ë™ê¸° XHR ë“±) -->
<script type="module">
  // ê´‘ê³  ì§€ì—° ì‚½ì… â†’ CLS => ì‚­ì œ í›„ HTMLë¡œ ì‚¬ìš©

  // ìŠ¤í¬ë¡¤/ë¦¬ì‚¬ì´ì¦ˆ: ë””ë°”ìš´ìŠ¤/ìŠ¤ë¡œí‹€ ì—†ìŒ + ê°•ì œ ë™ê¸° ë ˆì´ì•„ì›ƒ ì¸¡ì • ë°˜ë³µ
  let rafId = null
  function thrash() {
    if(rafId) {
      return
    }

    rafId = requestAnimationFrame(() => {
      rafId = null

      for (let i = 0; i < 100; i++) {
        document.body.style.marginLeft = (i % 2) ? '0px' : '1px';
        // ê°•ì œ ë¦¬í”Œë¡œìš° ìœ ë°œ ì¸¡ì •
        const w = document.body.getBoundingClientRect().width;
        console.log('layout width', w);
      }
    })
  }
  window.addEventListener('scroll', thrash);
  window.addEventListener('resize', thrash);

  // ëŒ€ê·œëª¨ DOM ìƒì„± (Coverage/Performance í™•ì¸ìš©)
  document.getElementById('build-dom').addEventListener('click', () => {
    const frag = document.createDocumentFragment();
    const zone = document.getElementById('table-zone');
    const table = document.createElement('table');
    table.border = '1';
    const rows = 300, cols = 20;
    for (let r = 0; r < rows; r++) {
      const tr = document.createElement('tr');
      for (let c = 0; c < cols; c++) {
        const td = document.createElement('td');
        td.textContent = `R${r}-C${c}-` + Math.random().toString(36).slice(2);
        tr.appendChild(td);
      }
      table.appendChild(tr);
    }
    zone.replaceChild(frag.appendChild(table));
  });

  // ë™ê¸°ì‹ XHR (ë©”ì¸ ìŠ¤ë ˆë“œ ë¸”ë¡œí‚¹)
  document.getElementById('sync-xhr').addEventListener('click', () => {
    try {
      var xhr = new XMLHttpRequest();
      xhr.open('GET', 'https://httpstat.us/200?sleep=1500&cache_bust=' + Date.now(), false); // ë™ê¸°ì‹ ìš”ì²­
      xhr.send();
      alert('ë™ê¸°ì‹ XHR ì™„ë£Œ: status ' + xhr.status);
    } catch (e) { console.warn(e); }
  });

  // ì£¼ê¸°ì ìœ¼ë¡œ ë¶ˆí•„ìš”í•œ ë¬´ê±°ìš´ ì‘ì—… ì‹¤í–‰ (CPU ì†Œëª¨)
  setInterval(() => {
    const a = Array.from({length: 150000}, (_, i) => Math.sqrt(i));
    a.reverse();
  }, 4000);
</script>
</body>
</html>