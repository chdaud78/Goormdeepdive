<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <title>ê°ì²´ì§€í–¥ Todo</title>
    <style>
        :root {
            --bg: #f7fbf7;
            --card: #fff;
            --text: #222;
            --muted: #667;
            --accent: #16a34a;
            --border: #e5e7eb;
        }

        * {
            box-sizing: border-box
        }

        body {
            margin: 0;
            background: var(--bg);
            color: var(--text);
            font-family: system-ui, Segoe UI, Apple SD Gothic Neo, -apple-system, sans-serif
        }

        .wrap {
            max-width: 720px;
            margin: 40px auto;
            padding: 24px
        }

        .card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, .04)
        }

        h1 {
            margin: 4px 0 16px;
            font-size: 24px
        }

        form {
            display: flex;
            gap: 8px
        }

        input[type=text] {
            flex: 1;
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 12px 14px;
            font-size: 16px
        }

        button {
            border: 0;
            border-radius: 10px;
            background: var(--accent);
            color: #fff;
            padding: 12px 16px;
            cursor: pointer
        }

        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 16px 0 8px
        }

        .filters {
            display: flex;
            gap: 8px
        }

        .filter {
            border: 1px solid var(--border);
            background: #fff;
            color: var(--text)
        }

        .filter.active {
            background: var(--accent);
            color: #fff;
            border-color: transparent
        }

        ul {
            list-style: none;
            margin: 0;
            padding: 0;
            display: grid;
            gap: 8px
        }

        li {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 14px;
            border: 1px solid var(--border);
            border-radius: 12px;
            background: #fff
        }

        li.done {
            opacity: .7
        }

        .text {
            flex: 1
        }

        .del {
            background: #ef4444
        }

        .empty {
            padding: 28px;
            text-align: center;
            color: var(--muted);
            border: 1px dashed var(--border);
            border-radius: 12px;
            background: #fff
        }

        .stats {
            color: var(--muted);
            font-size: 14px
        }
    </style>
</head>

<body>
<div class="wrap">
    <div class="card">
        <h1>ğŸ§© ê°ì²´ì§€í–¥ Todo</h1>

        <form id="form" autocomplete="off">
            <input id="todo-input" type="text" placeholder="í•  ì¼ì„ ì…ë ¥í•˜ê³  Enter" minlength="1" maxlength="100" required />
            <button type="submit">ì¶”ê°€</button>
        </form>

        <div class="toolbar">
            <div class="filters">
                <button class="filter" data-mode="all">ì „ì²´</button>
                <button class="filter" data-mode="active">ë¯¸ì™„ë£Œ</button>
                <button class="filter" data-mode="done">ì™„ë£Œ</button>
            </div>
            <div class="stats" id="stats">ì´ 0 Â· ì™„ë£Œ 0 Â· ë¯¸ì™„ë£Œ 0</div>
        </div>

        <ul id="list"></ul>
        <div class="empty" id="empty" hidden>ì•„ì§ í•  ì¼ì´ ì—†ì–´ìš” âœ¨</div>
    </div>
</div>

<script>
  /* ===== ìœ í‹¸ ===== */
  const uid = () =>
    (crypto.randomUUID?.() || (Date.now() + Math.random().toString(16).slice(2))); // ê³ ìœ  ID
  const escapeHtml = s =>
    s.replace(/[&<>"']/g, m => ({ '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;' }[m])); // XSS ë°©ì§€

  /* ===== ìŠ¤í† ì–´(ê°ì²´ì§€í–¥) ===== */
  class TodoStore {
    #list = []; // ë¹„ê³µê°œ ìƒíƒœ(ìº¡ìŠí™”)

    add(text) { // í•­ëª© ì¶”ê°€
      const t = { id: uid(), text: text.trim(), done: false }; // ìƒˆ í•­ëª©
      if (!t.text) return; // ê³µë°±ì´ë©´ ë¬´ì‹œ
      this.#list.unshift(t); // ì•ì— ì¶”ê°€(ìµœì‹ ìˆœ)
      return t.id; // ìƒì„±ëœ id ë°˜í™˜
    }

    toggle(id) { // ì™„ë£Œ í† ê¸€
      const i = this.#list.findIndex(t => t.id === id); // ëŒ€ìƒ ì¸ë±ìŠ¤
      if (i >= 0) this.#list[i] = { ...this.#list[i], done: !this.#list[i].done }; // ë¶ˆë³€ ì—…ë°ì´íŠ¸ì²˜ëŸ¼ êµì²´
    }

    remove(id) { // ì‚­ì œ
      this.#list = this.#list.filter(t => t.id !== id); // í•„í„°ë¡œ ì œê±°
    }

    filter(mode = "all") { // ë³´ê¸° ëª¨ë“œë³„ ëª©ë¡
      const arr = (
        mode === "active" ? this.#list.filter(t => !t.done) :
          mode === "done" ? this.#list.filter(t => t.done) :
            this.#list
      );
      return arr.map(t => ({ ...t })); // ì™¸ë¶€ë¡œëŠ” ë³µì œ(ë‚´ë¶€ ë³´í˜¸)
    }

    stats() { // í†µê³„
      const total = this.#list.length; // ì „ì²´
      const done = this.#list.filter(t => t.done).length; // ì™„ë£Œ
      return { total, done, active: total - done }; // ë¯¸ì™„ë£Œ ê³„ì‚°
    }

    snapshot() { return this.filter("all"); } // ì „ì²´ ë³µì œ ë°˜í™˜(ì½ê¸°ìš©)
  }

  /* ===== ì¸ìŠ¤í„´ìŠ¤ & UI ìƒíƒœ ===== */
  const store = new TodoStore(); // ìŠ¤í† ì–´ ìƒì„±
  let mode = "all"; // ë³´ê¸° ëª¨ë“œ ìƒíƒœ

  /* ===== ë Œë” ===== */
  const $list = document.getElementById("list"); // ëª©ë¡ DOM
  const $empty = document.getElementById("empty"); // ë¹ˆ ì•ˆë‚´ DOM
  const $stats = document.getElementById("stats"); // í†µê³„ DOM

  // í™”ë©´ ê°±ì‹ 
  function render() {
    let viewLists = store.filter(mode);

    // ê° í•­ëª©ì„ lië¡œ ê·¸ë¦¬ê¸°
    $list.innerHTML = viewLists.map(viewList =>
      (`<li class="${viewList.done? "done": ''}">
            <input id="todoCheck" type="checkbox" ${viewList.done? "checked" : ""} data-id="${viewList.id}">
            <p class="text">${escapeHtml(viewList.text)}</p>
            <button class="del" data-id="${viewList.id}">ì‚­ì œ</button>
        </li>`)
    ).join('');

    // checkbox ì´ë²¤íŠ¸
    $list.querySelectorAll('input[type="checkbox"]').forEach(c => {
      c.addEventListener('change', () => {
        store.toggle(c.dataset.id);
        render();
      })
    });

    // ì‚­ì œ ì´ë²¤íŠ¸
    $list.querySelectorAll('.del').forEach(d => {
      d.addEventListener('click', () => {
        store.remove(d.dataset.id);
        render();
      })
    });

    // ë¹„ì–´ìˆìœ¼ë©´ ì•ˆë‚´ í‘œì‹œ
    $empty.hidden = viewLists.length > 0;

    // í†µê³„ ê°±ì‹ 
    const {total, done, active} = store.stats();
    $stats.innerText = `ì´ ${total} Â· ì™„ë£Œ ${done} Â· ë¯¸ì™„ë£Œ ${active}`

    // í™œì„± í•„í„° ë²„íŠ¼ í‘œì‹œ
    document.querySelectorAll(".filter").forEach(btn => {
      btn.classList.toggle("active", btn.dataset.mode === mode);
    });
  }

  /* ===== ì´ë²¤íŠ¸ ===== */

  // í¼ ì œì¶œ â†’ ì¶”ê°€
  document.getElementById("form").addEventListener("submit", (e) => {
    e.preventDefault(); // ìƒˆë¡œê³ ì¹¨ ë°©ì§€
    const input = document.getElementById("todo-input"); // ì…ë ¥ DOM
    store.add(input.value); // ìŠ¤í† ì–´ì— ì¶”ê°€
    input.value = ""; // ì…ë ¥ ì´ˆê¸°í™”
    render(); // í™”ë©´ ê°±ì‹ 
  });

  // í•„í„° ë²„íŠ¼ í´ë¦­ â†’ ëª¨ë“œ ë³€ê²½
  document.querySelectorAll(".filter").forEach(btn => {
    btn.addEventListener("click", () => {
      mode = btn.dataset.mode; // ëª¨ë“œ ìƒíƒœ ë°˜ì˜
      render(); // ê°±ì‹ 
    });
  });

  render(); // ìµœì´ˆ 1íšŒ ë Œë”
</script>
</body>

</html>